<!DOCTYPE html>
<html>
<head><title>Heights of You</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon" href="../images/circle180.png"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0, user-scalable=no">

<!-- Android, not sure if working --> 
<meta name="theme-color" content="#014473">

<style> 
body {
padding: 0; 
margin: 0;
-webkit-user-select: none;
} 
</style>
<script language="javascript" type="text/javascript" src="https://class.arts.ucsb.edu/~art102/includes/p5/p5.js"></script>
<script language="javascript" type="text/javascript" src="https://class.arts.ucsb.edu/~art102/includes/p5/addons/p5.sound.js"></script>
<script>
	//song used - Such Great Heights by The Postal Service

	var radiusX;
	var radiusY;
	var radius;
	var amount_of_rects = 10;
	var amount_of_rect = 100;
	var loc;
	var song;
	var amp;
	var angle = 0;
	
	function preload(){
		song = loadSound('data/heights.mp3');
	}
	
	function setup() {
		createCanvas(displayWidth, displayHeight)
		song.setVolume(0.5);
		song.play();
		analyzer= new p5.Amplitude();
		angleMode(DEGREES);
		
	}
	  
	function draw() {
		//background('white');
		frameRate(24);
		var s = floor(song.currentTime());
		
		//blue circles background
		push();
		for(i=0;i<amount_of_rects;i++){
			radiusX = random(0, displayWidth);
			radiusY = random(0, displayHeight);
			var myred=random(150, 200);
			var mygreen=255;
			var myblue=255;
			var myc=color(myred,mygreen,myblue);
			fill(myc);
			noStroke();
		
			var myw = random(15, 35)
			var myh = random(15, 35)
			var circle_center_x=displayWidth/2
			var circle_center_y=displayHeight/2
			var myx=(circle_center_x + radiusX * Math.cos(2 * Math.PI * i / amount_of_rects));
			var myy=(circle_center_y + radiusY * Math.sin(2 * Math.PI * i / amount_of_rects));	

			var corner_r=random(10)
			rect(myx, myy, myw, myh, corner_r)
		}
		pop();
		
		//yellow circles background
		push();
		if (s > 20) {
		for(i=0;i<amount_of_rects;i++){
			radiusX = random(0, displayWidth);
			radiusY = random(0, displayHeight);
			var myred=255;
			var mygreen=255;
			var myblue=random(200, 255);
			var myc=color(myred,mygreen,myblue, 150);
			fill(myc);
			noStroke();
		
			var amp = analyzer.getLevel();
			var myw= random(50, 50+amp*10);
			var myh = random(50, 50+amp*10);
			var circle_center_x=displayWidth/2;
			var circle_center_y=displayHeight/2;
			var myx=(circle_center_x + radiusX * Math.cos(2 * Math.PI * i / amount_of_rects));
			var myy=(circle_center_y + radiusY * Math.sin(2 * Math.PI * i / amount_of_rects));	

			var corner_r=random(10);
			rect(myx, myy, myw, myh, corner_r);
		}
		}
		pop();
		
		//green circles
		push();
		if (s > 37) {
			amount_of_rects = 300;
		for(i=0;i<amount_of_rect;i++){
			var amp = analyzer.getLevel();
			radius = amp*700;
			var myred=0;
			var mygreen=255;
			var myblue=random(200, 255);
			var myc=color(myred,mygreen,myblue, 90);
			fill(myc);
			noStroke();
		
			var myw= random(10, 20);
			var myh = random(10, 20);
			var circle_center_x=(displayWidth/2)-10;
			var circle_center_y=(displayHeight/2)-10;
			var myx=(circle_center_x + radius * Math.cos(2 * Math.PI * i / amount_of_rect));
			var myy=(circle_center_y + radius * Math.sin(2 * Math.PI * i / amount_of_rect));	

			var corner_r=random(50, 80);
			rect(myx, myy, myw, myh, corner_r);
		}
		}
		pop();
		
		//yellow circles
		push();
		if (s > 77) {
		for(i=0;i<amount_of_rects;i++){
			var amp = analyzer.getLevel();
			radius = amp*3000;
			var myred=random(200, 255);
			var mygreen=255;
			var myblue=0
			var myc=color(myred,mygreen,myblue, amp*100);
			fill(myc);
			noStroke();
		
			var myw= random(10, 20);
			var myh = random(10, 20);
			var circle_center_x=(displayWidth/2)-10;
			var circle_center_y=(displayHeight/2)-10;
			var myx=(circle_center_x + radius * Math.cos(2 * Math.PI * i / amount_of_rects));
			var myy=(circle_center_y + radius * Math.sin(2 * Math.PI * i / amount_of_rects));
			
			var corner_r=random(50, 80);
			push();
			translate(displayWidth/2,displayHeight/2);
			rotate(angle);
			rect(myx, myy, myw, myh, corner_r);
			pop();
			
			angle = angle + 1;
		}
		}
		pop();
		
		//red circles
		push();
		if (s > 117.5) {
		for(i=0;i<amount_of_rects;i++){
			var amp = analyzer.getLevel();
			radius = amp*2000;
			var myred=255;
			var mygreen=0;
			var myblue=random(115,150);
			var myc=color(myred,mygreen,myblue, amp*100);
			fill(myc);
			noStroke();
		
			var myw= random(10, 20);
			var myh = random(10, 20);
			var circle_center_x=(displayWidth/2)-10;
			var circle_center_y=(displayHeight/2)-10;
			var myx=(circle_center_x + radius * Math.cos(2 * Math.PI * i / amount_of_rects));
			var myy=(circle_center_y + radius * Math.sin(2 * Math.PI * i / amount_of_rects));
			
			var corner_r=random(50, 80);
			push();
			translate(displayWidth/2,displayHeight/2);
			rotate(angle);
			rect(myx, myy, myw, myh, corner_r);
			pop();
			
			angle = angle + 1;
		}
		}
		pop();
		
		//last part
		push();
		if (s > 138) {
			var amp = analyzer.getLevel();
			background(255, amp*300);	
		} else if (s > 169) {
		  background(255);	
		}
		pop();
		
		//timer
		/*push();
		fill('white');
		ellipse(displayWidth/2, displayHeight/2, 50, 50);
		textSize(30);
		fill('black');
		text(s, (displayWidth/2)-10, (displayHeight/2)+10); 
		pop();*/
		
		// 57 to 77 sec
		// 97 to 117 sec
	}

	//this function is called when a ontouchmove is triggered in the body. It is not a p5 function
	function BlockMove(event) {
		// Tell the browser to not to "bounce" the content.
		event.preventDefault();
	}

</script>
</head>
<body ontouchmove="BlockMove(event);">
</body>
</html>